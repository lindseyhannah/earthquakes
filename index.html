<!DOCTYPE html>
<html>
<head>
	<!-- the mapbox libraries -->
	<title>Live data maps</title>

	<meta charset='utf-8' />
    
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.css' rel='stylesheet' />
    <link href='https://www.mapbox.com/base/latest/base.css' rel='stylesheet' />
   <!-- the leaflet CSS and JS library-->
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
	integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
	crossorigin=""/>
	<!-- Make sure you put this AFTER Leaflet's CSS -->
	<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
	integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
	crossorigin=""></script>
	<!-- the Omnivore plugin to convert KML to GeoJSON -->
	<script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.2.0/leaflet-omnivore.min.js'></script> 

	<style>
        
        body { margin:0; padding:0; }
        #map {height: 70vh; width: 99%; padding: 10px }
        #map2 {height: 70vh; width: 99%, padding: 10px}
	
	

		h1 {
		font-family: 'Source Sans Pro', sans-serif;
		font-size: 19pt;
		font-weight: 300;
		line-height: 1.75em;
		color: #282828;
		padding-left: 10px; 
		
	}
		p {
		font-family: 'Source Sans Pro', sans-serif;
		font-size: 10pt;
		font-weight: 300;
		line-height: 1.75em;
		color: #282828;
		padding-left: 10px;
		}

	</style>

</head>
<body>
<!-- Thanks to Mapbox toggle tutorial for this code https://www.mapbox.com/mapbox-gl-js/example/toggle-layers/-->

<style>
/* style for the toggle button */
    #menu {
        background: #fff;
        position: absolute;
        z-index: 1;
        top: 200px;
        left: 20px;
        border-radius: 3px;
        width: 120px;
        border: 1px solid rgba(0,0,0,0.4);
        font-family: 'Open Sans', sans-serif;
    }

    #menu a {
        font-size: 13px;
        color: #404040;
        display: block;
        margin: 0;
        padding: 0;
        padding: 10px;
        text-decoration: none;
        border-bottom: 1px solid rgba(0,0,0,0.25);
        text-align: center;
    }

    #menu a:last-child {
        border: none;
    }

    #menu a:hover {
        background-color: #f8f8f8;
        color: #404040;
    }

    #menu a.active {
        background-color: #3887be;
        color: #ffffff;
    }

    #menu a.active:hover {
        background: #3074a4;
    }

    /* Style for the Return Home Button.*/

        #gohome {
        display: block;
        position: absolute;
        
        top: 260px;
        left: 20px;
        border-radius: 3px;
        width: 120px;
        border: 1px solid rgba(0,0,0,0.4);
        font-size: 12px;
        text-align: center;
        color: #fff;
        background: #CC6822
    } 

     	#gohome2 {
        display: block;
        position: absolute;
        bottom: 20px;
        left: 20px;
        border-radius: 3px;
        width: 120px;
        border: 1px solid rgba(0,0,0,0.4);
        font-size: 12px;
        text-align: center;
        color: #fff;
        background: #CC6822


</style>
 
<h1 style= "padding: 10px"> USGS Recorded Earthquakes </h1>
<hr>
<p> Points represent all events with magnitude 2.5 or greater occuring over the past 7 days.  Information updates every 5 minutes.  </p>
<nav id="menu"></nav>

	<div id='map'></div>
	
	<button id= "gohome"> Full Extent </button>

	<script>
	mapboxgl.accessToken = 'pk.eyJ1IjoibG1oYW5uYWgiLCJhIjoiY2pvNHYzNnZ4MDBuNjNxcHUwZzR3dmR5bSJ9.c2ULzGUVCYiPhkvdiqTRZw';
		var map = new mapboxgl.Map({
		container: 'map',
		style: 'mapbox://styles/lmhannah/cjoj9wpdv9cr32rmnje5hm7mj',
		});
		map.setCenter([-174, 20]);
		map.setZoom(1);

		map.on('load', function(){
			//Adds all earthquakes in the past 7days greater than 2.5 mag
			map.addSource('earthquakes', {
				"type": "geojson",
				"data": "https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_week.geojson"
			});
			map.addSource('Tectonic plates', {
				"type": "geojson",
				"data": "plates.geojson"
			
			});
			
			map.addLayer({
				"id":"quakes",
				"type": "circle",
				"source": "earthquakes",
				"layout": {
					"visibility": "visible",
				},
				//style the markers
				"paint": {
					"circle-color": "#FF0800",
					"circle-radius": {
						property: 'mag',
						type: 'exponential',
						stops: [
						[0.5, .5],
						[1, 1],
						[2, 2],
						[3, 3],
						[4, 4],
						[5, 5],
						[6, 6],
						[7, 7],
						[8, 8],
						[9, 9],
						[10, 10]
						]
						},			
						"circle-opacity": 0.5
					} 

			});
			map.addLayer({
							"id": "Tectonic plates",
							"type": "line",
							"source": "Tectonic plates",
							"layout": {
							"visibility": "visible",
							},
	
						});

			map.on('click', 'quakes', function (e) {
				var coordinates= e.features[0].geometry.coordinates.slice();
				var description= "<p>Magnitude: "+e.features[0].properties.mag+"<br>Location: "+e.features[0].properties.place+"<br> URL: <a target= '_blank' href= '"+e.features[0].properties.url+"'> Click here for more information about this event </a> </p>"
			//popup only appears over feature being pointed to if map is zoomed out	
				while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
					coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
				}
			
           //add popup to map
			new mapboxgl.Popup()
				.setLngLat(coordinates)
				.setHTML(description)
				.addTo(map);

		});
			//change cursor to pointer when hovering over element
			//code taken from Mapbox pop-up on click tutorial
			map.on('mouseenter', 'quakes', function() {
				map.getCanvas().style.cursor= 'pointer';
			});
			map.on('mouseleave', 'quakes', function() {
				map.getCanvas().style.cursor = '';
			});
		});

//Thanks to the Mapbox tutorial for this code to toddle layers on/off		
var toggle = [ 'Tectonic plates'];

for (var i = 0; i < toggle.length; i++) {
    var id = toggle[i];

    var link = document.createElement('a');
    link.href = '#';
    link.className = 'active';
    link.textContent = id;

    link.onclick = function (e) {
        var clickedLayer = this.textContent;
        e.preventDefault();
        e.stopPropagation();

        var visibility = map.getLayoutProperty(clickedLayer, 'visibility');

        if (visibility === 'visible') {
            map.setLayoutProperty(clickedLayer, 'visibility', 'none');
            this.className = '';
        } else {
            this.className = 'active';
            map.setLayoutProperty(clickedLayer, 'visibility', 'visible');
        }
    };

    var layers = document.getElementById('menu');
    layers.appendChild(link);
}

	document.getElementById('gohome').addEventListener('click', function () {
			map.setCenter([-174, 20]);
		    map.setZoom(1);
			});



// Add zoom and rotation controls to the map.
map.addControl(new mapboxgl.NavigationControl()
	);

	
	</script>

<hr>


	<!--Map 2-->
<hr>
<hr>

<h1 style= "padding: 10px"> MODIS Predicted Active Wildfires </h1>
<p> MODIS is a satellite in orbit with several different instruments used to monitor and collect data about Earth's Surface.  MODIS is able to detect "thermal anomalies" which are often wild fires.  These detected thermal anomalies are mapped below. </p>

<button id= "gohome2"> Full Extent </button>

		<div id="map2"></div>
	<!-- the script for my map -->
	<script>
			//basemap from https://leaflet-extras.github.io/leaflet-providers/preview/ 
			var Esri_WorldStreetMap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan, METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012'
});
			var map2 = new L.Map("map2", {
				center: new L.LatLng(39, -96.4),
				zoom: 2
			});
			map2.addLayer(Esri_WorldStreetMap);

			//add a KML layer - uses cors-anywhere to bypass the CORS restrictions on NOAA. TEMPORARY WORKAROUND, Eventually need to hook up a server instead of doing it this way. 
			var fire = omnivore.kml('https://cors-anywhere.herokuapp.com/https://firms.modaps.eosdis.nasa.gov/active_fire/c6/kml/MODIS_C6_USA_contiguous_and_Hawaii_48h.kml')
				.on('ready', function() {
			        map2.fitBounds(fire.getBounds());
			    })
			.addTo(map2);

			document.getElementById('gohome2').addEventListener('click', function () {
				map2.setCenter([39, -96.4]);
		   		map2.setZoom(2);
			});
			</script>

		</body>
		</html>
	
 
</body>
</html>


